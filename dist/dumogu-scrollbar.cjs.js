/*!
 * dumogu-scrollbar v0.0.3
 * Copyright 2025 wuzhanggui https://github.com/wurencaideli
 * Licensed under MIT
 */
"use strict";class t{isMounted=!0;isDestroyed=!1;constructor(){}destroy(){this.isDestroyed=!0}mount(){this.isMounted=!0}unmount(){this.isMounted=!1}}class e extends t{isX;keepShow=!1;stopClickPropagation=!1;targetEl;railEl;railContainerEl;thumbEl;isTransitioning=!1;isDragging__=!1;isHover__=!1;startX=0;startY=0;proportion__=0;handleMousedown_;handleMouseMove_;handleMouseUp_;handleClick_;handleScroll_;handleMouseEnter_;handleMouseLeave_;constructor(t,e){super(),this.targetEl=t,this.isX=e.isX,this.keepShow=e.keepShow,this.stopClickPropagation=e.stopClickPropagation,this.railEl=document.createElement("div"),this.railContainerEl=document.createElement("div"),this.thumbEl=document.createElement("div"),this.railEl.classList.add("dumogu-scrollbar-target-rail"),this.railContainerEl.classList.add("dumogu-scrollbar-target-rail-container"),this.thumbEl.classList.add("dumogu-scrollbar-target-thumb"),this.railEl.classList.add("hidden"),this.railEl.classList.add(this.isX?"x":"y"),this.railContainerEl.classList.add(this.isX?"x":"y"),this.thumbEl.classList.add(this.isX?"x":"y"),this.keepShow&&this.railEl.classList.add("keep-show"),this.railEl.appendChild(this.railContainerEl),this.railContainerEl.appendChild(this.thumbEl),this.addEventListener()}set isDragging(t){this.isDragging__=t,this.setupActionClass()}get isDragging(){return this.isDragging__}set isHover(t){this.isHover__=t,this.setupActionClass()}get isHover(){return this.isHover__}set proportion(t){this.proportion__=t,this.setupHidden(),this.setupPosition()}get proportion(){return this.proportion__}setupHidden(){const t=this.railEl;this.proportion>=1?t.classList.add("hidden"):t.classList.remove("hidden")}setupActionClass(){const t=this.railEl;this.isDragging?t.classList.add("dragging"):t.classList.remove("dragging"),this.isHover?t.classList.add("hover"):t.classList.remove("hover")}setupPosition(){const t=this.targetEl,e=this.railContainerEl,s=this.thumbEl,i=Math.min(this.proportion,1);if(this.isX){const o=t.scrollLeft/(t.scrollWidth-t.clientWidth),r=Math.max(e.clientWidth*i,30);s.style.width=r+"px",s.style.left=(e.clientWidth-r)*o/e.clientWidth*100+"%"}else{const o=t.scrollTop/(t.scrollHeight-t.clientHeight),r=Math.max(e.clientHeight*i,30);s.style.height=r+"px",s.style.top=(e.clientHeight-r)*o/e.clientHeight*100+"%"}}computedProportion(){if(this.isDestroyed)return;const t=this.targetEl;let e=0;e=this.isX?t.clientWidth/t.scrollWidth:t.clientHeight/t.scrollHeight,this.proportion=e}handleMousedown(t){this.isDestroyed||(this.isDragging=!0,this.startX=t.x,this.startY=t.y)}handleMouseMove(t){if(this.isDestroyed)return;if(!this.isDragging)return;const e=this.targetEl,s=this.railContainerEl,i=s.getBoundingClientRect(),o=this.thumbEl,r=e.getBoundingClientRect();if(this.isX){const l=t.x,n=l-this.startX;if(this.startX=l,0==e.scrollLeft&&l<i.x)return;if(e.scrollLeft+r.width>=e.scrollWidth&&l>=i.x+i.width)return;const a=n/(s.clientWidth-o.offsetWidth)*(e.scrollWidth-e.clientWidth);e.scrollLeft=e.scrollLeft+a}else{const l=t.y,n=l-this.startY;if(this.startY=l,0==e.scrollTop&&l<i.y)return;if(e.scrollTop+r.height>=e.scrollHeight&&l>=i.y+i.height)return;const a=n/(s.clientHeight-o.offsetHeight)*(e.scrollHeight-e.clientHeight);e.scrollTop=e.scrollTop+a}}handleMouseUp(t){this.isDestroyed||(this.isDragging=!1)}handleScroll(t){this.isDestroyed||this.computedProportion()}handleClick(t){this.stopClickPropagation&&t.stopPropagation();const e=this.targetEl,s=this.thumbEl.getBoundingClientRect();this.isX?(t.x<s.x&&(e.scrollLeft=e.scrollLeft-e.clientWidth),t.x>s.x+s.width&&(e.scrollLeft=e.scrollLeft+e.clientWidth)):(t.y<s.y&&(e.scrollTop=e.scrollTop-e.clientHeight),t.y>s.y+s.height&&(e.scrollTop=e.scrollTop+e.clientHeight))}handleMouseEnter(){this.isHover=!0,this.computedProportion()}handleMouseLeave(){this.isHover=!1,this.computedProportion()}handleTransitionStart(){this.isTransitioning=!0,this.computedProportion()}handleTransitionEnd(){this.isTransitioning=!1,this.computedProportion()}addEventListener(){this.removeEventListener();const t=this.targetEl,e=this.railEl,s=this.thumbEl,i=this.railContainerEl,o=this;o.handleMousedown_=function(t){o.handleMousedown(t)},o.handleMouseMove_=function(t){o.handleMouseMove(t)},o.handleMouseUp_=function(t){o.handleMouseUp(t)},o.handleScroll_=function(t){o.handleScroll(t)},o.handleClick_=function(t){o.handleClick(t)},o.handleMouseEnter_=function(t){o.handleMouseEnter(t)},o.handleMouseLeave_=function(t){o.handleMouseLeave(t)},o.handleTransitionStart_=function(t){o.handleTransitionStart(t)},o.handleTransitionEnd_=function(t){o.handleTransitionEnd(t)},s.addEventListener("mousedown",o.handleMousedown_),document.addEventListener("mousemove",o.handleMouseMove_),document.addEventListener("mouseup",o.handleMouseUp_),i.addEventListener("click",o.handleClick_),t.addEventListener("scroll",o.handleScroll_),e.addEventListener("mouseenter",o.handleMouseEnter_),e.addEventListener("mouseleave",o.handleMouseLeave_),e.addEventListener("transitionstart",o.handleTransitionStart_),e.addEventListener("transitionend",o.handleTransitionEnd_)}removeEventListener(){const t=this.targetEl,e=this.thumbEl,s=this.railContainerEl;e.removeEventListener("mousedown",this.handleMousedown_),document.removeEventListener("mousemove",this.handleMouseMove_),document.removeEventListener("mouseup",this.handleMouseUp_),s.removeEventListener("click",this.handleClick_),t.removeEventListener("scroll",this.handleScroll_),t.removeEventListener("mouseenter",this.handleMouseEnter_),t.removeEventListener("mouseleave",this.handleMouseLeave_)}destroy(){this.unmount(),this.removeEventListener(),this.railEl=void 0,this.railContainerEl=void 0,this.thumbEl=void 0,this.isDestroyed=!0}}class s extends t{targetEl;scrollbarEl;scrollbarTargetEl;constructor(t,e){super(),this.targetEl=t,this.scrollbarEl=document.createElement("div"),this.scrollbarTargetEl=document.createElement("div"),this.scrollbarEl.classList.add("dumogu-scrollbar"),this.scrollbarTargetEl.classList.add("dumogu-scrollbar-target")}computedPosition(t){if(!this.isMounted||this.isDestroyed)return;const e=this.targetEl,s=this.scrollbarTargetEl,i=t.targetElRect||e.getBoundingClientRect();s.style.width=i.width+"px",s.style.height=i.height+"px",s.style.top=i.y+"px",s.style.left=i.x+"px"}destroy(){this.unmount(),this.targetEl=void 0,this.scrollbarEl=void 0,this.scrollbarTargetEl=void 0,this.isDestroyed=!0}}exports.DumoguScrollbar=class extends t{targetEl;scrollbar;railX;railY;isHover=!1;handleMouseEnter_;handleMouseLeave_;constructor(t,i={}){super(),this.targetEl=t,this.scrollbar=new s(t),this.railX=new e(t,{isX:!0,keepShow:i.keepShow,stopClickPropagation:i.stopClickPropagation}),this.railY=new e(t,{isX:!1,keepShow:i.keepShow,stopClickPropagation:i.stopClickPropagation});const o=this.scrollbar.scrollbarEl,r=this.scrollbar.scrollbarTargetEl;r.appendChild(this.railX.railEl),r.appendChild(this.railY.railEl),o.appendChild(r),this.addEventListener(),this.mount(),this.update()}handleMouseEnter(){this.isHover=!0,this.update()}handleMouseLeave(){this.isHover=!1,this.update()}addEventListener(){const t=this.targetEl,e=this;this.handleMouseEnter_=function(){e.handleMouseEnter()},this.handleMouseLeave_=function(){e.handleMouseLeave()},t.addEventListener("mouseenter",this.handleMouseEnter_),t.addEventListener("mouseleave",this.handleMouseLeave_)}removeEventListener(){this.targetEl.removeEventListener("mouseenter",this.handleMouseEnter),this.targetEl.removeEventListener("mouseleave",this.handleMouseLeave)}update(){if(this.isDestroyed)return;const t=this.targetEl.getBoundingClientRect();this.scrollbar.computedPosition({targetElRect:t}),this.railX.computedProportion(),this.railY.computedProportion(),this.isHover?(this.railX.railEl.classList.add("target-hover"),this.railY.railEl.classList.add("target-hover")):(this.railY.railEl.classList.remove("target-hover"),this.railX.railEl.classList.remove("target-hover"))}mount(){document.body.appendChild(this.scrollbar.scrollbarEl),this.isMounted=!0}unmount(){var t;(t=this.scrollbar.scrollbarEl)&&t.parentNode&&t.parentNode.removeChild(t),this.isMounted=!1}destroy(){this.unmount(),this.scrollbar.destroy(),this.railX.destroy(),this.railY.destroy(),this.removeEventListener(),this.targetEl=void 0,this.scrollbar=void 0,this.railX=void 0,this.railY=void 0,this.isDestroyed=!0}};
//# sourceMappingURL=dumogu-scrollbar.cjs.js.map
