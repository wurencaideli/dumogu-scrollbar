/*!
 * dumogu-scrollbar v0.0.3
 * Copyright 2025 wuzhanggui https://github.com/wurencaideli
 * Licensed under MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["dumogu-scrollbar"]={})}(this,function(t){"use strict";class e{isMounted=!0;isDestroyed=!1;constructor(){}destroy(){this.isDestroyed=!0}mount(){this.isMounted=!0}unmount(){this.isMounted=!1}}class i extends e{isX;keepShow=!1;stopClickPropagation=!1;targetEl;railEl;railContainerEl;thumbEl;isTransitioning=!1;isDragging__=!1;isHover__=!1;startX=0;startY=0;proportion__=0;handleMousedown_;handleMouseMove_;handleMouseUp_;handleClick_;handleScroll_;handleMouseEnter_;handleMouseLeave_;constructor(t,e){super(),this.targetEl=t,this.isX=e.isX,this.keepShow=e.keepShow,this.stopClickPropagation=e.stopClickPropagation,this.railEl=document.createElement("div"),this.railContainerEl=document.createElement("div"),this.thumbEl=document.createElement("div"),this.railEl.classList.add("dumogu-scrollbar-target-rail"),this.railContainerEl.classList.add("dumogu-scrollbar-target-rail-container"),this.thumbEl.classList.add("dumogu-scrollbar-target-thumb"),this.railEl.classList.add("hidden"),this.railEl.classList.add(this.isX?"x":"y"),this.railContainerEl.classList.add(this.isX?"x":"y"),this.thumbEl.classList.add(this.isX?"x":"y"),this.keepShow&&this.railEl.classList.add("keep-show"),this.railEl.appendChild(this.railContainerEl),this.railContainerEl.appendChild(this.thumbEl),this.addEventListener()}set isDragging(t){this.isDragging__=t,this.setupActionClass()}get isDragging(){return this.isDragging__}set isHover(t){this.isHover__=t,this.setupActionClass()}get isHover(){return this.isHover__}set proportion(t){this.proportion__=t,this.setupHidden(),this.setupPosition()}get proportion(){return this.proportion__}setupHidden(){const t=this.railEl;this.proportion>=1?t.classList.add("hidden"):t.classList.remove("hidden")}setupActionClass(){const t=this.railEl;this.isDragging?t.classList.add("dragging"):t.classList.remove("dragging"),this.isHover?t.classList.add("hover"):t.classList.remove("hover")}setupPosition(){const t=this.targetEl,e=this.railContainerEl,i=this.thumbEl,s=Math.min(this.proportion,1);if(this.isX){const o=t.scrollLeft/(t.scrollWidth-t.clientWidth),r=Math.max(e.clientWidth*s,30);i.style.width=r+"px",i.style.left=(e.clientWidth-r)*o/e.clientWidth*100+"%"}else{const o=t.scrollTop/(t.scrollHeight-t.clientHeight),r=Math.max(e.clientHeight*s,30);i.style.height=r+"px",i.style.top=(e.clientHeight-r)*o/e.clientHeight*100+"%"}}computedProportion(){if(this.isDestroyed)return;const t=this.targetEl;let e=0;e=this.isX?t.clientWidth/t.scrollWidth:t.clientHeight/t.scrollHeight,this.proportion=e}handleMousedown(t){this.isDestroyed||(this.isDragging=!0,this.startX=t.x,this.startY=t.y)}handleMouseMove(t){if(this.isDestroyed)return;if(!this.isDragging)return;const e=this.targetEl,i=this.railContainerEl,s=i.getBoundingClientRect(),o=this.thumbEl,r=e.getBoundingClientRect();if(this.isX){const l=t.x,n=l-this.startX;if(this.startX=l,0==e.scrollLeft&&l<s.x)return;if(e.scrollLeft+r.width>=e.scrollWidth&&l>=s.x+s.width)return;const a=n/(i.clientWidth-o.offsetWidth)*(e.scrollWidth-e.clientWidth);e.scrollLeft=e.scrollLeft+a}else{const l=t.y,n=l-this.startY;if(this.startY=l,0==e.scrollTop&&l<s.y)return;if(e.scrollTop+r.height>=e.scrollHeight&&l>=s.y+s.height)return;const a=n/(i.clientHeight-o.offsetHeight)*(e.scrollHeight-e.clientHeight);e.scrollTop=e.scrollTop+a}}handleMouseUp(t){this.isDestroyed||(this.isDragging=!1)}handleScroll(t){this.isDestroyed||this.computedProportion()}handleClick(t){this.stopClickPropagation&&t.stopPropagation();const e=this.targetEl,i=this.thumbEl.getBoundingClientRect();this.isX?(t.x<i.x&&(e.scrollLeft=e.scrollLeft-e.clientWidth),t.x>i.x+i.width&&(e.scrollLeft=e.scrollLeft+e.clientWidth)):(t.y<i.y&&(e.scrollTop=e.scrollTop-e.clientHeight),t.y>i.y+i.height&&(e.scrollTop=e.scrollTop+e.clientHeight))}handleMouseEnter(){this.isHover=!0,this.computedProportion()}handleMouseLeave(){this.isHover=!1,this.computedProportion()}handleTransitionStart(){this.isTransitioning=!0,this.computedProportion()}handleTransitionEnd(){this.isTransitioning=!1,this.computedProportion()}addEventListener(){this.removeEventListener();const t=this.targetEl,e=this.railEl,i=this.thumbEl,s=this.railContainerEl,o=this;o.handleMousedown_=function(t){o.handleMousedown(t)},o.handleMouseMove_=function(t){o.handleMouseMove(t)},o.handleMouseUp_=function(t){o.handleMouseUp(t)},o.handleScroll_=function(t){o.handleScroll(t)},o.handleClick_=function(t){o.handleClick(t)},o.handleMouseEnter_=function(t){o.handleMouseEnter(t)},o.handleMouseLeave_=function(t){o.handleMouseLeave(t)},o.handleTransitionStart_=function(t){o.handleTransitionStart(t)},o.handleTransitionEnd_=function(t){o.handleTransitionEnd(t)},i.addEventListener("mousedown",o.handleMousedown_),document.addEventListener("mousemove",o.handleMouseMove_),document.addEventListener("mouseup",o.handleMouseUp_),s.addEventListener("click",o.handleClick_),t.addEventListener("scroll",o.handleScroll_),e.addEventListener("mouseenter",o.handleMouseEnter_),e.addEventListener("mouseleave",o.handleMouseLeave_),e.addEventListener("transitionstart",o.handleTransitionStart_),e.addEventListener("transitionend",o.handleTransitionEnd_)}removeEventListener(){const t=this.targetEl,e=this.thumbEl,i=this.railContainerEl;e.removeEventListener("mousedown",this.handleMousedown_),document.removeEventListener("mousemove",this.handleMouseMove_),document.removeEventListener("mouseup",this.handleMouseUp_),i.removeEventListener("click",this.handleClick_),t.removeEventListener("scroll",this.handleScroll_),t.removeEventListener("mouseenter",this.handleMouseEnter_),t.removeEventListener("mouseleave",this.handleMouseLeave_)}destroy(){this.unmount(),this.removeEventListener(),this.railEl=void 0,this.railContainerEl=void 0,this.thumbEl=void 0,this.isDestroyed=!0}}class s extends e{targetEl;scrollbarEl;scrollbarTargetEl;constructor(t,e){super(),this.targetEl=t,this.scrollbarEl=document.createElement("div"),this.scrollbarTargetEl=document.createElement("div"),this.scrollbarEl.classList.add("dumogu-scrollbar"),this.scrollbarTargetEl.classList.add("dumogu-scrollbar-target")}computedPosition(t){if(!this.isMounted||this.isDestroyed)return;const e=this.targetEl,i=this.scrollbarTargetEl,s=t.targetElRect||e.getBoundingClientRect();i.style.width=s.width+"px",i.style.height=s.height+"px",i.style.top=s.y+"px",i.style.left=s.x+"px"}destroy(){this.unmount(),this.targetEl=void 0,this.scrollbarEl=void 0,this.scrollbarTargetEl=void 0,this.isDestroyed=!0}}t.DumoguScrollbar=class extends e{targetEl;scrollbar;railX;railY;isHover=!1;handleMouseEnter_;handleMouseLeave_;constructor(t,e={}){super(),this.targetEl=t,this.scrollbar=new s(t),this.railX=new i(t,{isX:!0,keepShow:e.keepShow,stopClickPropagation:e.stopClickPropagation}),this.railY=new i(t,{isX:!1,keepShow:e.keepShow,stopClickPropagation:e.stopClickPropagation});const o=this.scrollbar.scrollbarEl,r=this.scrollbar.scrollbarTargetEl;r.appendChild(this.railX.railEl),r.appendChild(this.railY.railEl),o.appendChild(r),this.addEventListener(),this.mount(),this.update()}handleMouseEnter(){this.isHover=!0,this.update()}handleMouseLeave(){this.isHover=!1,this.update()}addEventListener(){const t=this.targetEl,e=this;this.handleMouseEnter_=function(){e.handleMouseEnter()},this.handleMouseLeave_=function(){e.handleMouseLeave()},t.addEventListener("mouseenter",this.handleMouseEnter_),t.addEventListener("mouseleave",this.handleMouseLeave_)}removeEventListener(){this.targetEl.removeEventListener("mouseenter",this.handleMouseEnter),this.targetEl.removeEventListener("mouseleave",this.handleMouseLeave)}update(){if(this.isDestroyed)return;const t=this.targetEl.getBoundingClientRect();this.scrollbar.computedPosition({targetElRect:t}),this.railX.computedProportion(),this.railY.computedProportion(),this.isHover?(this.railX.railEl.classList.add("target-hover"),this.railY.railEl.classList.add("target-hover")):(this.railY.railEl.classList.remove("target-hover"),this.railX.railEl.classList.remove("target-hover"))}mount(){document.body.appendChild(this.scrollbar.scrollbarEl),this.isMounted=!0}unmount(){var t;(t=this.scrollbar.scrollbarEl)&&t.parentNode&&t.parentNode.removeChild(t),this.isMounted=!1}destroy(){this.unmount(),this.scrollbar.destroy(),this.railX.destroy(),this.railY.destroy(),this.removeEventListener(),this.targetEl=void 0,this.scrollbar=void 0,this.railX=void 0,this.railY=void 0,this.isDestroyed=!0}}});
//# sourceMappingURL=dumogu-scrollbar.umd.js.map
