/*!
 * dumogu-scrollbar v0.0.5
 * Copyright 2025 wuzhanggui https://github.com/wurencaideli
 * Licensed under MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["dumogu-scrollbar"]={})}(this,function(t){"use strict";function e(t,e){t.classList.add(e)}function i(t,e){t.classList.remove(e)}function s(t){return t.getBoundingClientRect()}class o{isMounted=!1;isDestroyed=!1;constructor(){}destroy(){this.isDestroyed=!0}mount(){this.isMounted=!0}unmount(){this.isMounted=!1}}class r extends o{targetEl;railEl;railContainerEl;thumbEl;targetIsWidow=!1;#t=!0;#e=!1;stopClickPropagation=!1;isTransitioning=!1;#i=!1;#s=!1;#o=!1;#r=0;startX=0;startY=0;#n;#l;#a;#h;#d;#u;#c;#g;#p;#m;#_;constructor(t){super();const i=document.createElement("div"),s=document.createElement("div"),o=document.createElement("div");e(i,"dumogu-scrollbar-target-rail"),e(s,"dumogu-scrollbar-target-rail-container"),e(o,"dumogu-scrollbar-target-thumb"),e(i,"hidden"),i.appendChild(s),s.appendChild(o),this.railEl=i,this.railContainerEl=s,this.thumbEl=o,this.stopClickPropagation=t.stopClickPropagation,this.isX=t.isX,this.keepShow=t.keepShow}bind(t){this.isDestroyed||(this.targetEl=t,this.targetIsWidow=!t,this.#v(),this.#E())}set isX(t){this.#t=t,this.#y()}get isX(){return this.#t}set keepShow(t){this.#e=t,this.#y()}get keepShow(){return this.#e}set isDragging(t){this.#i=t,this.#y()}get isDragging(){return this.#i}set isHover(t){this.#s=t,this.#y()}get isHover(){return this.#s}set isTargetHover(t){this.#o=t,this.#y()}get isTargetHover(){return this.#o}set proportion(t){this.#r=t,this.#w(),this.#T()}get proportion(){return this.#r}#w(){if(this.isDestroyed)return;const t=this.railEl;this.proportion>=1?e(t,"hidden"):i(t,"hidden")}#y(){if(this.isDestroyed)return;const t=this.railEl,s=this.railContainerEl,o=this.thumbEl;this.keepShow?e(t,"keep-show"):i(t,"keep-show"),this.isDragging?e(t,"dragging"):i(t,"dragging"),this.isHover?e(t,"hover"):i(t,"hover"),this.isTargetHover?e(t,"target-hover"):i(t,"target-hover"),this.isX?(i(t,"y"),i(s,"y"),i(o,"y"),e(t,"x"),e(s,"x"),e(o,"x")):(i(t,"x"),i(s,"x"),i(o,"x"),e(t,"y"),e(s,"y"),e(o,"y"))}#M(){const t=this.targetEl,e=this.targetIsWidow;let i=0,s=0,o=0;return this.isX?(i=e?window.innerWidth:t.clientWidth,s=e?document.documentElement.scrollWidth:t.scrollWidth,o=e?window.scrollX:t.scrollLeft):(i=e?window.innerHeight:t.clientHeight,s=e?document.documentElement.scrollHeight:t.scrollHeight,o=e?window.scrollY:t.scrollTop),{clientSize:i,scrollSize:s,scrollStart:o}}#S(t){if(this.isDestroyed)return;const e=this.targetEl,i=this.targetIsWidow;this.isX?i?window.scrollTo(t,window.scrollY):e.scrollLeft=t:i?window.scrollTo(window.scrollX,t):e.scrollTop=t}update(){this.#f()}#f(){if(this.isDestroyed)return;const t=this.#M();let e=0,i=0;e=t.clientSize/t.scrollSize,i=t.scrollStart/(t.scrollSize-t.clientSize),this.scrollProportion=Math.min(i,1),this.proportion=Math.min(e,1)}#T(){if(this.isDestroyed)return;const t=this.railContainerEl,e=this.thumbEl,i=this.proportion,s=this.scrollProportion,o=this.isX?t.clientWidth:t.clientHeight,r=Math.max(o*i,30),n=(o-r)*s/o*100;this.isX?(e.style.width=r+"px",e.style.left=n+"%"):(e.style.height=r+"px",e.style.top=n+"%")}#C(t){this.isDestroyed||(this.isDragging=!0,this.startX=t.x,this.startY=t.y)}#b(t){if(this.isDestroyed)return;if(!this.isDragging)return;const e=this.#M(),i=this.railContainerEl,o=s(i),r=this.thumbEl;let n=0;const l=t.x,a=t.y;if(this.isX){if(n=l-this.startX,this.startX=l,0==e.scrollStart&&l<o.x)return;if(e.scrollStart+e.clientSize>=e.scrollSize&&l>=o.x+o.width)return;const t=n/(i.clientWidth-r.offsetWidth)*(e.scrollSize-e.clientSize);this.#S(e.scrollStart+t)}else{if(n=a-this.startY,this.startY=a,0==e.scrollStart&&a<o.y)return;if(e.scrollStart+e.clientSize>=e.scrollSize&&a>=o.y+o.height)return;const t=n/(i.clientHeight-r.offsetHeight)*(e.scrollSize-e.clientSize);this.#S(e.scrollStart+t)}}#x(){this.isDestroyed||(this.isDragging=!1)}#D(){this.isDestroyed||this.#f()}#k(t){if(this.isDestroyed)return;this.stopClickPropagation&&t.stopPropagation();const e=this.#M(),i=s(this.thumbEl);let o=!1;this.isX?t.x>i.x+i.width&&(o=!0):t.y>i.y+i.width&&(o=!0),o?this.#S(e.scrollStart+e.clientSize):this.#S(e.scrollStart-e.clientSize)}#X(){this.isHover=!0,this.#f()}#L(){this.isHover=!1,this.#f()}#H(t){const e=this.railEl;t&&t.target===e&&"opacity"===t.propertyName&&(this.isTransitioning=!0,this.#f())}#P(t){const e=this.railEl;t&&t.target===e&&"opacity"===t.propertyName&&(this.isTransitioning=!1,this.#f())}#W(){this.isTargetHover=!0,this.#f()}#z(){this.isTargetHover=!1,this.#f()}#E(){const t=this.targetEl,e=this.railEl,i=this.thumbEl,s=this.railContainerEl,o=this;o.#n=function(t){o.#C(t)},o.#l=function(t){o.#b(t)},o.#a=function(t){o.#x(t)},o.#d=function(t){o.#D(t)},o.#h=function(t){o.#k(t)},o.#u=function(t){o.#X(t)},o.#c=function(t){o.#L(t)},o.#m=function(t){o.#H(t)},o.#_=function(t){o.#P(t)},o.#g=function(t){o.#W(t)},o.#p=function(t){o.#z(t)};const r="addEventListener";i[r]("mousedown",o.#n),document[r]("mousemove",o.#l),document[r]("mouseup",o.#a),s[r]("click",o.#h),this.targetIsWidow?(window[r]("scroll",o.#d),document[r]("mouseenter",o.#g),document[r]("mouseleave",o.#p)):(t[r]("scroll",o.#d),t[r]("mouseenter",o.#g),t[r]("mouseleave",o.#p)),e[r]("mouseenter",o.#u),e[r]("mouseleave",o.#c),e[r]("transitionstart",o.#m),e[r]("transitionend",o.#_)}#v(){const t=this.targetEl,e=this.railEl,i=this.thumbEl,s=this.railContainerEl,o="removeEventListener";i[o]("mousedown",this.#n),document[o]("mousemove",this.#l),document[o]("mouseup",this.#a),s[o]("click",this.#h),this.targetIsWidow?(window[o]("scroll",this.#d),document[o]("mouseenter",this.#g),document[o]("mouseleave",this.#p)):(t[o]("scroll",this.#d),t[o]("mouseenter",this.#g),t[o]("mouseleave",this.#p)),e[o]("mouseenter",this.#u),e[o]("mouseleave",this.#c),e[o]("transitionstart",this.#m),e[o]("transitionend",this.#_)}destroy(){this.isDestroyed||(super.unmount(),super.destroy(),this.#v(),this.railEl=void 0,this.railContainerEl=void 0,this.thumbEl=void 0,this.#n=void 0,this.#l=void 0,this.#a=void 0,this.#h=void 0,this.#d=void 0,this.#u=void 0,this.#c=void 0,this.#g=void 0,this.#p=void 0,this.#m=void 0,this.#_=void 0)}}t.DumoguScrollbar=class extends o{targetEl;mountContainerEl;mountedToBody=!0;targetIsWidow=!0;scrollbarEl;scrollbarTargetEl;railX;railY;constructor(t={}){super();const i=document.createElement("div"),s=document.createElement("div"),o=new r({isX:!0,keepShow:t.keepShow,stopClickPropagation:t.stopClickPropagation}),n=new r({isX:!1,keepShow:t.keepShow,stopClickPropagation:t.stopClickPropagation});e(i,"dumogu-scrollbar"),e(s,"dumogu-scrollbar-target"),s.appendChild(o.railEl),s.appendChild(n.railEl),i.appendChild(s),this.scrollbarEl=i,this.scrollbarTargetEl=s,this.railX=o,this.railY=n}bind(t){this.isDestroyed||(this.targetEl=t,this.targetIsWidow=!t,this.railX.bind(t),this.railY.bind(t))}mount(t){this.isDestroyed||(super.mount(),this.mountContainerEl=t,t?(t.appendChild(this.scrollbarEl),this.mountedToBody=!1):(document.body.appendChild(this.scrollbarEl),this.mountedToBody=!0),this.#y(),this.#A())}unmount(){var t;this.isDestroyed||(super.unmount(),(t=this.scrollbarEl)&&t.parentNode&&t.parentNode.removeChild(t))}#y(){if(this.isDestroyed)return;const t=this.scrollbarEl;this.mountedToBody?e(t,"mounted-to-body"):i(t,"mounted-to-body"),this.targetIsWidow?e(t,"is-window"):i(t,"is-window")}update(){if(this.isDestroyed)return;const t=this.railX,e=this.railY;this.#A(),t.isDragging||t.update(),e.isDragging||e.update()}#A(){if(this.isDestroyed)return;const t=this.targetEl,e=this.mountContainerEl,i=this.scrollbarEl,o=this.scrollbarTargetEl;if(this.targetIsWidow)return o.style.width="100%",void(o.style.height="100%");if(this.mountedToBody){const e=s(t);return o.style.width=e.width+"px",o.style.height=e.height+"px",o.style.top=e.y+"px",void(o.style.left=e.x+"px")}const r=s(i),n=s(t),l=s(e);o.style.width=n.width+"px",o.style.height=n.height+"px",o.style.top=n.y-l.y-(r.y-l.y)+"px",o.style.left=n.x-l.x-(r.x-l.x)+"px"}destroy(){this.isDestroyed||(this.unmount(),super.destroy(),this.railX.destroy(),this.railY.destroy(),this.railX=void 0,this.railY=void 0,this.targetEl=void 0,this.mountContainerEl=void 0,this.scrollbarEl=void 0,this.scrollbarTargetEl=void 0)}},t.Rail=r});
//# sourceMappingURL=dumogu-scrollbar.umd.js.map
