/*!
 * dumogu-scrollbar v0.0.5
 * Copyright 2025 wuzhanggui https://github.com/wurencaideli
 * Licensed under MIT
 */
function t(t,e){t.classList.add(e)}function e(t,e){t.classList.remove(e)}function i(t){return t.getBoundingClientRect()}class s{isMounted=!1;isDestroyed=!1;constructor(){}destroy(){this.isDestroyed=!0}mount(){this.isMounted=!0}unmount(){this.isMounted=!1}}class o extends s{targetEl;railEl;railContainerEl;thumbEl;targetIsWidow=!1;#t=!0;#e=!1;stopClickPropagation=!1;isTransitioning=!1;#i=!1;#s=!1;#o=!1;#r=0;startX=0;startY=0;#n;#l;#a;#h;#d;#u;#c;#g;#p;#m;#_;constructor(e){super();const i=document.createElement("div"),s=document.createElement("div"),o=document.createElement("div");t(i,"dumogu-scrollbar-target-rail"),t(s,"dumogu-scrollbar-target-rail-container"),t(o,"dumogu-scrollbar-target-thumb"),t(i,"hidden"),i.appendChild(s),s.appendChild(o),this.railEl=i,this.railContainerEl=s,this.thumbEl=o,this.stopClickPropagation=e.stopClickPropagation,this.isX=e.isX,this.keepShow=e.keepShow}bind(t){this.isDestroyed||(this.targetEl=t,this.targetIsWidow=!t,this.#v(),this.#E())}set isX(t){this.#t=t,this.#y()}get isX(){return this.#t}set keepShow(t){this.#e=t,this.#y()}get keepShow(){return this.#e}set isDragging(t){this.#i=t,this.#y()}get isDragging(){return this.#i}set isHover(t){this.#s=t,this.#y()}get isHover(){return this.#s}set isTargetHover(t){this.#o=t,this.#y()}get isTargetHover(){return this.#o}set proportion(t){this.#r=t,this.#w(),this.#M()}get proportion(){return this.#r}#w(){if(this.isDestroyed)return;const i=this.railEl;this.proportion>=1?t(i,"hidden"):e(i,"hidden")}#y(){if(this.isDestroyed)return;const i=this.railEl,s=this.railContainerEl,o=this.thumbEl;this.keepShow?t(i,"keep-show"):e(i,"keep-show"),this.isDragging?t(i,"dragging"):e(i,"dragging"),this.isHover?t(i,"hover"):e(i,"hover"),this.isTargetHover?t(i,"target-hover"):e(i,"target-hover"),this.isX?(e(i,"y"),e(s,"y"),e(o,"y"),t(i,"x"),t(s,"x"),t(o,"x")):(e(i,"x"),e(s,"x"),e(o,"x"),t(i,"y"),t(s,"y"),t(o,"y"))}#T(){const t=this.targetEl,e=this.targetIsWidow;let i=0,s=0,o=0;return this.isX?(i=e?window.innerWidth:t.clientWidth,s=e?document.documentElement.scrollWidth:t.scrollWidth,o=e?window.scrollX:t.scrollLeft):(i=e?window.innerHeight:t.clientHeight,s=e?document.documentElement.scrollHeight:t.scrollHeight,o=e?window.scrollY:t.scrollTop),{clientSize:i,scrollSize:s,scrollStart:o}}#S(t){if(this.isDestroyed)return;const e=this.targetEl,i=this.targetIsWidow;this.isX?i?window.scrollTo(t,window.scrollY):e.scrollLeft=t:i?window.scrollTo(window.scrollX,t):e.scrollTop=t}update(){this.#C()}#C(){if(this.isDestroyed)return;const t=this.#T();let e=0,i=0;e=t.clientSize/t.scrollSize,i=t.scrollStart/(t.scrollSize-t.clientSize),this.scrollProportion=Math.min(i,1),this.proportion=Math.min(e,1)}#M(){if(this.isDestroyed)return;const t=this.railContainerEl,e=this.thumbEl,i=this.proportion,s=this.scrollProportion,o=this.isX?t.clientWidth:t.clientHeight,r=Math.max(o*i,30),n=(o-r)*s/o*100;this.isX?(e.style.width=r+"px",e.style.left=n+"%"):(e.style.height=r+"px",e.style.top=n+"%")}#f(t){this.isDestroyed||(this.isDragging=!0,this.startX=t.x,this.startY=t.y)}#b(t){if(this.isDestroyed)return;if(!this.isDragging)return;const e=this.#T(),s=this.railContainerEl,o=i(s),r=this.thumbEl;let n=0;const l=t.x,a=t.y;if(this.isX){if(n=l-this.startX,this.startX=l,0==e.scrollStart&&l<o.x)return;if(e.scrollStart+e.clientSize>=e.scrollSize&&l>=o.x+o.width)return;const t=n/(s.clientWidth-r.offsetWidth)*(e.scrollSize-e.clientSize);this.#S(e.scrollStart+t)}else{if(n=a-this.startY,this.startY=a,0==e.scrollStart&&a<o.y)return;if(e.scrollStart+e.clientSize>=e.scrollSize&&a>=o.y+o.height)return;const t=n/(s.clientHeight-r.offsetHeight)*(e.scrollSize-e.clientSize);this.#S(e.scrollStart+t)}}#D(){this.isDestroyed||(this.isDragging=!1)}#k(){this.isDestroyed||this.#C()}#x(t){if(this.isDestroyed)return;this.stopClickPropagation&&t.stopPropagation();const e=this.#T(),s=i(this.thumbEl);let o=!1;this.isX?t.x>s.x+s.width&&(o=!0):t.y>s.y+s.width&&(o=!0),o?this.#S(e.scrollStart+e.clientSize):this.#S(e.scrollStart-e.clientSize)}#X(){this.isHover=!0,this.#C()}#L(){this.isHover=!1,this.#C()}#H(t){const e=this.railEl;t&&t.target===e&&"opacity"===t.propertyName&&(this.isTransitioning=!0,this.#C())}#P(t){const e=this.railEl;t&&t.target===e&&"opacity"===t.propertyName&&(this.isTransitioning=!1,this.#C())}#W(){this.isTargetHover=!0,this.#C()}#z(){this.isTargetHover=!1,this.#C()}#E(){const t=this.targetEl,e=this.railEl,i=this.thumbEl,s=this.railContainerEl,o=this;o.#n=function(t){o.#f(t)},o.#l=function(t){o.#b(t)},o.#a=function(t){o.#D(t)},o.#d=function(t){o.#k(t)},o.#h=function(t){o.#x(t)},o.#u=function(t){o.#X(t)},o.#c=function(t){o.#L(t)},o.#m=function(t){o.#H(t)},o.#_=function(t){o.#P(t)},o.#g=function(t){o.#W(t)},o.#p=function(t){o.#z(t)};const r="addEventListener";i[r]("mousedown",o.#n),document[r]("mousemove",o.#l),document[r]("mouseup",o.#a),s[r]("click",o.#h),this.targetIsWidow?(window[r]("scroll",o.#d),document[r]("mouseenter",o.#g),document[r]("mouseleave",o.#p)):(t[r]("scroll",o.#d),t[r]("mouseenter",o.#g),t[r]("mouseleave",o.#p)),e[r]("mouseenter",o.#u),e[r]("mouseleave",o.#c),e[r]("transitionstart",o.#m),e[r]("transitionend",o.#_)}#v(){const t=this.targetEl,e=this.railEl,i=this.thumbEl,s=this.railContainerEl,o="removeEventListener";i[o]("mousedown",this.#n),document[o]("mousemove",this.#l),document[o]("mouseup",this.#a),s[o]("click",this.#h),this.targetIsWidow?(window[o]("scroll",this.#d),document[o]("mouseenter",this.#g),document[o]("mouseleave",this.#p)):(t[o]("scroll",this.#d),t[o]("mouseenter",this.#g),t[o]("mouseleave",this.#p)),e[o]("mouseenter",this.#u),e[o]("mouseleave",this.#c),e[o]("transitionstart",this.#m),e[o]("transitionend",this.#_)}destroy(){this.isDestroyed||(super.unmount(),super.destroy(),this.#v(),this.railEl=void 0,this.railContainerEl=void 0,this.thumbEl=void 0,this.#n=void 0,this.#l=void 0,this.#a=void 0,this.#h=void 0,this.#d=void 0,this.#u=void 0,this.#c=void 0,this.#g=void 0,this.#p=void 0,this.#m=void 0,this.#_=void 0)}}class r extends s{targetEl;mountContainerEl;mountedToBody=!0;targetIsWidow=!0;scrollbarEl;scrollbarTargetEl;railX;railY;constructor(e={}){super();const i=document.createElement("div"),s=document.createElement("div"),r=new o({isX:!0,keepShow:e.keepShow,stopClickPropagation:e.stopClickPropagation}),n=new o({isX:!1,keepShow:e.keepShow,stopClickPropagation:e.stopClickPropagation});t(i,"dumogu-scrollbar"),t(s,"dumogu-scrollbar-target"),s.appendChild(r.railEl),s.appendChild(n.railEl),i.appendChild(s),this.scrollbarEl=i,this.scrollbarTargetEl=s,this.railX=r,this.railY=n}bind(t){this.isDestroyed||(this.targetEl=t,this.targetIsWidow=!t,this.railX.bind(t),this.railY.bind(t))}mount(t){this.isDestroyed||(super.mount(),this.mountContainerEl=t,t?(t.appendChild(this.scrollbarEl),this.mountedToBody=!1):(document.body.appendChild(this.scrollbarEl),this.mountedToBody=!0),this.#y(),this.#A())}unmount(){var t;this.isDestroyed||(super.unmount(),(t=this.scrollbarEl)&&t.parentNode&&t.parentNode.removeChild(t))}#y(){if(this.isDestroyed)return;const i=this.scrollbarEl;this.mountedToBody?t(i,"mounted-to-body"):e(i,"mounted-to-body"),this.targetIsWidow?t(i,"is-window"):e(i,"is-window")}update(){if(this.isDestroyed)return;const t=this.railX,e=this.railY;this.#A(),t.isDragging||t.update(),e.isDragging||e.update()}#A(){if(this.isDestroyed)return;const t=this.targetEl,e=this.mountContainerEl,s=this.scrollbarEl,o=this.scrollbarTargetEl;if(this.targetIsWidow)return o.style.width="100%",void(o.style.height="100%");if(this.mountedToBody){const e=i(t);return o.style.width=e.width+"px",o.style.height=e.height+"px",o.style.top=e.y+"px",void(o.style.left=e.x+"px")}const r=i(s),n=i(t),l=i(e);o.style.width=n.width+"px",o.style.height=n.height+"px",o.style.top=n.y-l.y-(r.y-l.y)+"px",o.style.left=n.x-l.x-(r.x-l.x)+"px"}destroy(){this.isDestroyed||(this.unmount(),super.destroy(),this.railX.destroy(),this.railY.destroy(),this.railX=void 0,this.railY=void 0,this.targetEl=void 0,this.mountContainerEl=void 0,this.scrollbarEl=void 0,this.scrollbarTargetEl=void 0)}}export{r as DumoguScrollbar,o as Rail};
//# sourceMappingURL=dumogu-scrollbar.esm.js.map
